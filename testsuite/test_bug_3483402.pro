; by GD
pro test_bug_3483402, test=test

good1=[[[1.41421,1.41421,1.41421],[ 2.23607,2.23607,2.23607],[ 3.16228,3.16228,3.16228],[ 4.12311,4.12311,4.12311]], $
[[ 2.23607,2.23607,2.23607],[ 2.82843,2.82843,2.82843],[ 3.60555,3.60555,3.60555],[ 4.47214,4.47214,4.47214]], $
[[ 3.16228,3.16228,3.16228],[ 3.60555,3.60555,3.60555],[ 4.24264,4.24264,4.24264],[ 5.00000,5.00000,5.00000]], $
[[ 2.23607,2.23607,2.23607],[ 2.82843,2.82843,2.82843],[ 3.60555,3.60555,3.60555],[ 4.47214,4.47214,4.47214]]]
good2=[[[3.75318,3.75318,3.75318,3.75318,3.75318],$
[5.53523,5.53523,5.53523,5.53523,5.53523]],$
[[4.21408,4.21408,4.21408,4.21408,4.21408],$
[5.85982,5.85982,5.85982,5.85982,5.85982]]]

b=fltarr(5,17,6)
b[0,*,*]=dist(17,6)
b[1,*,*]=dist(17,6)
b[2,*,*]=dist(17,6)
b[3,*,*]=dist(17,6)
b[4,*,*]=dist(17,6)
c1= INTERPOLATE(b, [0,1,2], [1,2,3,4],[1,2,3,4],/gri)
c2= INTERPOLATE(b, [3.3,5.255],[4.2,2.55],/gri,cubic=-0.3)

if (TOTAL(c1-good1)/4/4/3 ge 1E-4 or TOTAL(c2-good2)/5/2/2 ge 1E-4) then begin
    MESSAGE, /continue, 'Error in interpolate, bug 3483402'
    if ~KEYWORD_SET(test) then EXIT, status=1
endif
end
